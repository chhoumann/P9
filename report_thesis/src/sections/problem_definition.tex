\section{Problem Definition}\label{sec:problem_definition}
The primary objective of this research is to accurately and robustly quantify the chemical compositions of Martian geological samples using \gls{libs} spectral data.
This task involves significant challenges, including the high dimensionality of spectral data, multicollinearity, matrix effects, and limited data availability.

\gls{libs} spectral data provides intensity readings across a spectrum of wavelengths in the form of Clean, Calibrated Spectra \cite{andersonImprovedAccuracyQuantitative2017}, as described by \citet{wiensPreflightCalibrationInitial2013}.
The wavelength intensities are quantified in units of photon/shot/mm\textsuperscript{2}/sr/nm.

Formally, the problem can be described as follows:
\newcounter{listitem}
\begin{itemize}[topsep=0pt]
    \refstepcounter{listitem}
    \item \textbf{Concentration Matrix} $\;\mathbf{C}[\chi, o]$: This matrix denotes the chemical concentrations in weight percent for oxides indexed by $o$ across samples indexed by $\chi$. Here, $\chi$ represents the index for samples and $o$ denotes the index for oxides (different chemical compounds being quantified).
    \label{matrix:concentration}

    \refstepcounter{listitem}
    \item \textbf{Intensity Matrix} $\;\mathbf{I}[\chi, l, s, \lambda]$: Holds the spectral intensity data, where each entry represents the intensity recorded for a sample $\chi$ at location $l$, for shot $s$, at wavelength $\lambda$. $l$ indicates the location on the sample where the measurement is taken, and $\lambda$ is the index for wavelengths (specific wavelengths of light measured by the spectrometers).
    \label{matrix:intensity}

    \refstepcounter{listitem}
    \item \textbf{Averaged Intensity Matrix} $\;\mathbf{A}[\chi, l, \lambda]$: Derived from matrix $\mathbf{I}$ by averaging the intensities across shots to provide a clearer signal for each location and wavelength:
    \[
    A[\chi, l, \lambda] = \frac{1}{|S|} \sum_{s \in S} I[\chi, l, s, \lambda].
    \]
    \label{matrix:averaged_intensity}

    \refstepcounter{listitem}
    \item \textbf{Masked Intensity Matrix} $\;\mathbf{M}[\chi, l, \lambda]$: The result of $\mathbf{A}$ processed by applying wavelength-specific masks, setting intensities to zero in masking ranges to focus on relevant spectral features.
    \label{matrix:masked_intensity}
\end{itemize}

The model outputs are the quantified chemical compositions of geological samples, primarily the concentrations of major elements, represented in weight percentage.
The task involves constructing a mapping function $\mathcal{F}: \mathbb{R}^N \rightarrow \mathbb{R}^{n_o}$, where $N$ represents the dimensionality of the processed \gls{libs} signals and $n_o$ denotes the number of target oxides in the Concentration Matrix $\mathbf{C}[\chi, o]$.
This function maps a processed \gls{libs} signal vector $\mathbf{x} \in \mathbb{R}^N$ to a vector $\mathbf{v} \in \mathbb{R}^{n_o}$ of estimated oxide concentrations.
The vector $\mathbf{x}$ is derived from matrix $\mathbf{M}$, representing processed spectral data:
\[
\mathbf{v} = \mathcal{F}(\mathbf{x}).
\]

Quantifying chemical compositions from \gls{libs} spectral data poses significant challenges:

\begin{itemize}
    \item \textbf{Data Dimensionality and Collinearity:} The high dimensionality of spectral data and the multicollinearity within this data pose significant challenges for modeling and analysis. The large number of dimensions leads to problems such as sparsity, ineffective distance metrics, overfitting, and increased computational complexity. The overlapping nature of emission lines from different elements results in high correlation between intensity readings at different wavelengths, making it difficult to extract independent spectral features necessary for accurate quantitative analysis \cite{andersonImprovedAccuracyQuantitative2017}.

    \item \textbf{Matrix Effects:} Matrix effects refer to variations in the intensity of emission lines of an element independent of its concentration, arising from the complex interplay of various physical processes within the plasma generated by the \gls{libs} technique. These effects can significantly alter emission intensities, complicating the extraction of accurate and independent spectral features. This makes it challenging to precisely map the processed \gls{libs} signal vector $\mathbf{x} \in \mathbb{R}^N$ to a vector $\mathbf{v} \in \mathbb{R}^{n_o}$ of estimated oxide concentrations, impacting the reliability of the predicted chemical compositions \cite{cleggRecalibrationMarsScience2017, andersonImprovedAccuracyQuantitative2017}.

    \item \textbf{Data Availability:} Due to the high cost of data collection, datasets are often small. This limits the number of samples available for evaluation, affecting the generalizability and robustness of the models \cite{p9_paper}.
\end{itemize}

Addressing these challenges requires the development of advanced computational models designed to improve the accuracy and robustness of chemical composition analysis with \gls{libs} data. 

Accuracy in this context is defined as the ability of a model to predict the composition of major oxides in Martian geological samples, while robustness refers to the stability of these predictions across different samples and oxides.
The metric used to evaluate the accuracy of the models is the Root Mean Squared Error (RMSE):
\[
\text{RMSE} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (\mathbf{v}_i - \hat{\mathbf{v}}_i)^2}
\]
where \( \mathbf{v}_i \) is the vector of actual oxide concentrations for the \( i \)-th sample, \( \hat{\mathbf{v}}_i \) is the corresponding vector of predicted oxide concentrations, and \( n \) is the total number of samples. This measure quantifies the average magnitude of the prediction error across all predicted values.

Robustness is evaluated using the sample standard deviation of prediction errors:
\[
\sigma_{error} = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (e_i - \bar{e})^2}
\]
where \( e_i = \mathbf{v}_i - \hat{\mathbf{v}}_i \) and \( \bar{e} \) is the mean error. A lower standard deviation indicates a more robust model across different samples.

\textbf{Proposed Approach:} To address the challenges in predicting major oxide compositions from \gls{libs} data, we propose to develop computational models capable of effectively accounting for and mitigating the complexities inherent in \gls{libs} data.
Our models will take as input a matrix in the form of $E$, as well as ground truth data in the form of $A$, to construct a mapping function $\mathcal{F}: \mathbb{R}^N \rightarrow \mathbb{R}^{n_{o}}$, mapping processed \gls{libs} signals to estimated oxide concentrations.

\subsection{Motivating Example: NASA's Mars Missions}
NASA's exploration of Mars, beginning with the Viking missions in the 1970s, has progressively deepened our understanding of Mars \cite{marsnasagov_vikings}.
The \gls{msl} mission, which landed the Curiosity rover in Gale Crater in 2012, represents a pivotal step in this journey.
Curiosity is equipped with the \gls{chemcam} instrument, a tool that uses \gls{libs} to analyze the chemical composition of Martian rocks and soils directly and non-invasively \cite{chemcamNasaWebsite}.

\gls{libs} is particularly suitable for the Martian environment because of its ability to perform rapid chemical analyses remotely, creating a plasma that can be spectrally analyzed to determine the elemental composition of the vaporized material.
This capability allows scientists to quickly and efficiently assess the geochemistry of multiple sites without physically moving the rover, thus conservatively managing the rover's limited energy and resources.
The mission's focus has been on assessing past habitability, and the data gathered by \gls{chemcam} has been instrumental in identifying environments that could have supported life \cite{chemcamNasaWebsite, curiosityNasaWebsite}.

The task of quantifying the oxides in Martian rock and soil samples begins with the \gls{libs} spectral data collected by Curiosity.
This data comprises high-dimensional spectra with thousands of potential features, each corresponding to a specific element's emission lines.
The computational challenge lies in accurately interpreting these complex data sets to deduce the concentrations of various elements, especially major oxides like iron, magnesium, and silicon, which are crucial for understanding Martian geology.

Following preprocessing to correct instrumental effects and calibrate spectra, the cleaned data is input into machine learning models.
These models, trained on databases of Earth-based and synthetic Martian analogs, output quantitative analyses of chemical compositions in weight percentages of the target oxides \cite{wiensPreflightCalibrationInitial2013, cleggRecalibrationMarsScience2017}.
\citet{cleggRecalibrationMarsScience2017} undertook this task and created a pipeline for predicting the concentration of oxides in Martian soil samples, referred to as \gls{moc}.

More recently, in 2022, the Perseverance rover landed on Mars, equipped with advanced instruments designed to continue the exploration and analysis of the Martian surface.
This rover also uses a \gls{libs} instrument, called SuperCam, which is the successor to \gls{chemcam}.
The Perseverance mission highlighted the ongoing research effort in developing elemental quantification models using \gls{libs} data \cite{andersonPostlandingMajorElement2022}, demonstrating its continued importance as a research field.

The use of \gls{libs} on the Curiosity rover within the MSL mission shows how computational advancements can enhance our understanding of extraterrestrial geology.
By effectively quantifying chemical compositions from \gls{libs} data, we can infer the historical climatic conditions of Mars, offering clues to its past habitability.
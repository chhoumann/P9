\section{Problem Definition}\label{sec:problem_definition}
The primary objective of this research is to systematically evaluate existing computational methods to identify the best-performing techniques and subsequently develop an optimized machine learning pipeline for accurately and robustly quantifying the chemical compositions of Martian geological samples using LIBS spectral data.

These computational methods process and model LIBS spectral data, which includes intensity readings across a spectrum of wavelengths. This data is in the form of Clean, Calibrated Spectra \cite{andersonImprovedAccuracyQuantitative2017}, the output of level 1 processing as described by \citet{wiensPreflightCalibrationInitial2013}. The wavelength intensities are quantified in units of photon/shot/mm\textsuperscript{2}/sr/nm.

Formally, we have:
\newcounter{listitem}
\begin{itemize}[topsep=0pt]
    \refstepcounter{listitem}
    \item \textbf{Concentration Matrix} $\;\mathbf{C}[\chi, o]$: This matrix denotes the chemical concentrations in weight percent for oxides indexed by $o$ across samples indexed by $\chi$. Here, $\chi$ represents the index for samples and $o$ denotes the index for oxides (different chemical compounds being quantified).
    \label{matrix:concentration}

    \refstepcounter{listitem}
    \item \textbf{Intensity Matrix} $\;\mathbf{I}[\chi, l, s, \lambda]$: Holds the spectral intensity data, where each entry represents the intensity recorded for a sample $\chi$ at location $l$, for shot $s$, at wavelength $\lambda$. $l$ indicates the location on the sample where the measurement is taken, and $\lambda$ is the index for wavelengths (specific wavelengths of light measured by the spectrometers).
    \label{matrix:intensity}

    \refstepcounter{listitem}
    \item \textbf{Averaged Intensity Matrix} $\;\mathbf{A}[\chi, l, \lambda]$: Derived from matrix $\mathbf{I}$ by averaging the intensities across shots to provide a clearer signal for each location and wavelength:
    \[
    A[\chi, l, \lambda] = \frac{1}{|S|} \sum_{s \in S} I[\chi, l, s, \lambda].
    \]
    \label{matrix:averaged_intensity}

    \refstepcounter{listitem}
    \item \textbf{Masked Intensity Matrix} $\;\mathbf{M}[\chi, l, \lambda]$: The result of $\mathbf{A}$ processed by applying wavelength-specific masks, setting intensities to zero in masking ranges to focus on relevant spectral features.
    \label{matrix:masked_intensity}
\end{itemize}

The model outputs are the quantified chemical compositions of geological samples. 
These are primarily the concentrations of major elements, represented in weight percentage. 
While background elements are also present, our current analysis does not quantify these. 
Our goal is to construct a mapping function $\mathcal{F}: \mathbb{R}^N \rightarrow \mathbb{R}^{n_o}$, where $N$ represents the dimensionality of the processed \gls{libs} signals and $n_o$ denotes the number of target oxides in the Concentration Matrix $\mathbf{C}[\chi, o]$.
This function maps a processed \gls{libs} signal vector $\mathbf{x} \in \mathbb{R}^N$ to a vector $\mathbf{v} \in \mathbb{R}^{n_o}$ of estimated oxide concentrations. The vector $\mathbf{x}$ is derived from matrix $\mathbf{M}$, representing processed spectral data:
\[
\mathbf{v} = \mathcal{F}(\mathbf{x}).
\]

As previously introduced, quantifying chemical compositions from \gls{libs} spectral data poses significant challenges, including high dimensionality and multicollinearity of the data, as well as matrix effects. Here, we further examine these challenges:

\begin{itemize}
    \item \textbf{Data Dimensionality and Collinearity:} The high dimensionality of spectral data and the multicollinearity within this data pose significant challenges for modeling and analysis.
The large number of dimensions leads to problems such as sparsity, ineffective distance metrics, overfitting, and increased computational complexity. 
This means that the captured data in the intensity matrix is made up of a significant amount of noise. This is mitigated to some extend by averaging the number of shots, producing the average intensity matrix, but the high number of wavelengths still present a challenge.
Similarly, due to the overlapping nature of emission lines from different elements, the intensity readings at different wavelengths are often highly correlated. 
This interdependency makes it difficult to extract independent spectral features necessary for accurate quantitative analysis\cite{andersonImprovedAccuracyQuantitative2017}.

    \item \textbf{Matrix Effects:} As noted in the introduction~\ref{sec:introduction}, matrix effects refer to any effect that can cause variations in the intensity of emission lines of an element independent of its concentration. These effects arise from the complex interplay of various physical processes within the plasma generated by the \gls{libs} technique. The presence of different background elements can significantly alter emission intensities by affecting these processes. This impacts the accuracy of our previously discussed mapping function $\mathcal{F}$, which quantifies chemical compositions from processed \gls{libs} signals. Variations in recorded intensities due to matrix effects complicate the extraction of accurate and independent spectral features because the overlapping and interaction of emission lines can mask or distort the true signal of individual elements. This makes it difficult to isolate the contributions of each element to the overall spectrum. Consequently, it becomes challenging to precisely map the processed \gls{libs} signal vector $\mathbf{x} \in \mathbb{R}^N$ to a vector $\mathbf{v} \in \mathbb{R}^{n_o}$ of estimated oxide concentrations, thereby impacting the reliability of the predicted chemical compositions~\cite{cleggRecalibrationMarsScience2017, andersonImprovedAccuracyQuantitative2017}.
    
    \item \textbf{Data Availability:} Due to the high cost of data collection, datasets are often small. 
    This cost affects the availability of samples $\chi$ in the Concentration Matrix $\mathbf{C[\chi, o]}$, limiting the number of samples available for evaluation, which is also true for the Intensity Matrix $\mathbf{I[\chi, l, s, \lambda]}$ and in turn the Averaged Intensity Matrix $\mathbf{A[\chi, l, \lambda]}$. 
    Consequently, the generalizability and robustness of the models can be limited~\cite{p9_paper}.
\end{itemize}

The complexities presented by these challenges require the creation of advanced computational models designed to address and alleviate such issues, thereby enhancing the accuracy and reliability of chemical composition analysis with \gls{libs} data.

As mentioned, our goals are to achieve improved accuracy and robustness.
We define accuracy as the ability of a model to predict the composition of major oxides in Martian geological samples, while robustness refers to the stability of these predictions across different samples and oxides.

The metric we use to evaluate the accuracy of our models is the \gls{rmse}. \gls{rmse} is calculated using the formula:
\[
\text{RMSE} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (\mathbf{v}_i - \hat{\mathbf{v}}_i)^2}
\]
where \( \mathbf{v}_i \) is the vector of actual oxide concentrations for the \( i \)-th sample, \( \hat{\mathbf{v}}_i \) is the corresponding vector of predicted oxide concentrations, and \( n \) is the total number of samples. This measure quantifies the average magnitude of the prediction error across all predicted values, providing a clear indication of model accuracy in quantifying chemical compositions.

We evaluate the robustness of our models using the sample standard deviation of prediction errors, defined as:
\[
\sigma_{error} = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (e_i - \bar{e})^2}
\]
where \( e_i = \mathbf{v}_i - \hat{\mathbf{v}}_i \) and \( \bar{e} \) is the mean error.
Sample standard deviation is used because it provides an unbiased estimate of the variability in prediction errors, crucial for assessing how well the model can be expected to perform on new, unseen data.
Correcting the variance calculation by using \( n-1 \) instead of \( n \) compensates for the tendency of smaller samples (specific datasets of \gls{libs} spectral data) to underestimate the variability of the entire population (all possible \gls{libs} data), bringing the sample standard deviation closer to the true standard deviation of the entire population.
A lower standard deviation indicates a more robust model across different samples.

Success will be evaluated primarily through these metrics, comparing the predictive accuracy and robustness of our models against existing benchmarks and baseline models established in prior research.

\textbf{Problem Definition:} This thesis aims to address the challenges in predicting major oxide compositions from \gls{libs} data by enhancing computational methods to improve accuracy and robustness. We propose to develop computational models capable of effectively accounting for and mitigating the complexities inherent in \gls{libs} data. Our models will take as input a matrix in the form of $E$, as well as ground truth data in the form of $A$, to construct a mapping function $\mathcal{F}: \mathbb{R}^N \rightarrow \mathbb{R}^{n_{o}}$, mapping processed \gls{libs} signals to estimated oxide concentrations.

\subsection{Motivating Example: NASA's Mars Missions}
NASA's exploration of Mars, beginning with the Viking missions in the 1970s, has progressively deepened our understanding of Mars\cite{marsnasagov_vikings}. The \gls{msl} mission, which landed the Curiosity rover in Gale Crater in 2012, represents a pivotal step in this journey. Curiosity is equipped with the \gls{chemcam} instrument, a tool that uses \gls{libs} to analyze the chemical composition of Martian rocks and soils directly and non-invasively\cite{chemcamNasaWebsite}.

\gls{libs} is particularly suitable for the Martian environment because of its ability to perform rapid chemical analyzes remotely, creating a plasma that can be spectrally analyzed to determine the elemental composition of the vaporized material. This capability is crucial because it allows scientists to quickly and efficiently assess the geochemistry of multiple sites without physically moving the rover, thus conservatively managing the rover's limited energy and resources. The mission's focus has been on assessing past habitability, and the data gathered by \gls{chemcam} has been instrumental in identifying environments that could have supported life\cite{chemcamNasaWebsite,curiosityNasaWebsite}.

As mentioned, the task of quantifying the oxides in Martian rock and soil samples begins with the \gls{libs} spectral data collected by Curiosity. This data comprises high-dimensional spectra with thousands of potential features, each corresponding to a specific element's emission lines. The computational challenge lies in accurately interpreting these complex data sets to deduce the concentrations of various elements, especially major oxides like iron, magnesium, and silicon, which are crucial for understanding Martian geology.
Initially, the data undergoes preprocessing to correct for any instrumental effects and to calibrate the raw spectra. This step ensures that the readings are accurate and can be reliably used for quantitative analysis. 
Following preprocessing to correct instrumental effects and calibrate spectra, the cleaned data is input into machine learning models. These models, trained on databases of Earth-based and synthetic Martian analogs, output quantitative analyses of chemical compositions in weight percentages of the target oxides\cite{wiensPreflightCalibrationInitial2013, cleggRecalibrationMarsScience2017}.
\citet{cleggRecalibrationMarsScience2017} undertook this task and created a pipeline for predicting the concentration of oxides in Martian soil samples, referred to as \gls{moc}.

More recently, in 2022, the Perseverance rover landed on Mars, equipped with advanced instruments designed to continue the exploration and analysis of the Martian surface. This rover also uses a \gls{libs} instrument, called SuperCam. This instrument is the successor to \gls{chemcam} and shows the continued success of the \gls{libs} technique in the Martian environment. The Perseverance mission highlighted the ongoing research effort in developing elemental quantification models using \gls{libs} data\cite{andersonPostlandingMajorElement2022}, demonstrating its continued importance as a research field.

The use of \gls{libs} on the Curiosity rover within the MSL mission shows how computational advancements can enhance our understanding of extraterrestrial geology. By effectively quantifying chemical compositions from \gls{libs} data, we can infer the historical climatic conditions of Mars, offering clues to its past habitability.
